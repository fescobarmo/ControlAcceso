# 🏗️ **DIAGRAMA DE ARQUITECTURA - CONTROLACCESO**

## 📊 **ARQUITECTURA GENERAL DEL SISTEMA**

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           🌐 CONTROLACCESO PLATFORM                             │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐             │
│  │   🌐 FRONTEND   │    │   ⚙️ BACKEND    │    │  🗄️ DATABASE   │             │
│  │                 │    │                 │    │                 │             │
│  │ React + MUI     │◄──►│ Node.js + API   │◄──►│ PostgreSQL      │             │
│  │ Nginx           │    │ Express         │    │ Sequelize ORM   │             │
│  │ Port: 3000      │    │ Port: 3001      │    │ Port: 5432      │             │
│  └─────────────────┘    └─────────────────┘    └─────────────────┘             │
│                                                                                 │
├─────────────────────────────────────────────────────────────────────────────────┤
│                          🐳 DOCKER CONTAINERS                                   │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                    docker-compose.yml                                   │   │
│  │                                                                         │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                    │   │
│  │  │   frontend  │  │   backend   │  │  database   │                    │   │
│  │  │             │  │             │  │             │                    │   │
│  │  │ controlacceso│  │ controlacceso│  │ controlacceso│                   │   │
│  │  │ -frontend   │  │ -backend    │  │ -database   │                    │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘                    │   │
│  │                                                                         │   │
│  │  🌐 Network: controlacceso-network (172.20.0.0/16)                     │   │
│  │  💾 Volumes: postgres_data, backend_logs, backend_uploads               │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
├─────────────────────────────────────────────────────────────────────────────────┤
│                        🚀 DEPLOYMENT PIPELINE                                   │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐      │
│  │   📝 CODE   │    │   🐙 GIT    │    │  🐳 DOCKER  │    │  🌊 DOCKER  │      │
│  │             │    │             │    │             │    │    HUB      │      │
│  │ Development │───►│   GitHub    │───►│   Build     │───►│   Registry  │      │
│  │   Local     │    │ Repository  │    │  Images     │    │  Public     │      │
│  └─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘      │
│                                                                                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                       │
│  │  🔄 GITHUB  │    │  🛡️ SECURITY │    │  🚀 PROD    │                       │
│  │   ACTIONS   │    │    SCAN     │    │  DEPLOY     │                       │
│  │             │    │             │    │             │                       │
│  │ CI/CD       │───►│   Trivy     │───►│  Staging    │                       │
│  │ Pipeline    │    │ Scanner     │    │Production   │                       │
│  └─────────────┘    └─────────────┘    └─────────────┘                       │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## 🔄 **FLUJO DE DATOS Y COMUNICACIÓN**

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           📊 DATA FLOW DIAGRAM                                  │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────┐    HTTP/API    ┌─────────────┐    SQL/ORM    ┌─────────────┐   │
│  │   👤 USER   │◄──────────────►│   🌐 FRONT  │◄─────────────►│   ⚙️ BACK   │   │
│  │             │                │    END      │               │    END      │   │
│  │ Browser     │                │ React App   │               │ Node.js API │   │
│  │ Interface   │                │ Material-UI │               │ Express     │   │
│  └─────────────┘                └─────────────┘               └─────────────┘   │
│                                                                      │           │
│                                                                      │           │
│                                                                      ▼           │
│                                                          ┌─────────────┐        │
│                                                          │  🗄️ DATABASE │        │
│                                                          │             │        │
│                                                          │ PostgreSQL  │        │
│                                                          │ Sequelize   │        │
│                                                          │ Models      │        │
│                                                          └─────────────┘        │
│                                                                                 │
├─────────────────────────────────────────────────────────────────────────────────┤
│                           🔐 AUTHENTICATION FLOW                               │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  1. 👤 User Login Request                                                       │
│     ┌─────────────┐    POST /api/auth/login    ┌─────────────┐                 │
│     │   👤 USER   │ ──────────────────────────► │   ⚙️ BACK   │                 │
│     │             │                            │    END      │                 │
│     └─────────────┘                            └─────────────┘                 │
│                                                                      │           │
│  2. 🔐 JWT Token Generation                                          │           │
│                                                          ┌─────────────┐        │
│                                                          │  🗄️ DATABASE │        │
│                                                          │ User Verify │        │
│                                                          └─────────────┘        │
│                                                                      │           │
│  3. 📝 Token Response                                               │           │
│     ┌─────────────┐    JWT Token + User Data  ┌─────────────┐                 │
│     │   👤 USER   │ ◄───────────────────────── │   ⚙️ BACK   │                 │
│     │             │                            │    END      │                 │
│     └─────────────┘                            └─────────────┘                 │
│                                                                                 │
│  4. 🔒 Protected Routes                                                         │
│     ┌─────────────┐    Bearer Token           ┌─────────────┐                 │
│     │   🌐 FRONT  │ ─────────────────────────► │   ⚙️ BACK   │                 │
│     │    END      │                            │    END      │                 │
│     └─────────────┘                            └─────────────┘                 │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## 🏗️ **ESTRUCTURA DE COMPONENTES FRONTEND**

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         🌐 FRONTEND COMPONENT TREE                              │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                            App.js                                       │   │
│  │  ┌─────────────────────────────────────────────────────────────────┐   │   │
│  │  │                    Router Configuration                         │   │   │
│  │  └─────────────────────────────────────────────────────────────────┘   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                     │                                           │
│                                     ▼                                           │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                      Protected Routes                                  │   │   │
│  │  ┌─────────────────────────────────────────────────────────────────┐   │   │
│  │  │                        Layout.js                                │   │   │
│  │  │  ┌─────────────────────────────────────────────────────────┐   │   │   │
│  │  │  │                Navigation + Sidebar                    │   │   │   │
│  │  │  └─────────────────────────────────────────────────────────┘   │   │   │
│  │  │  ┌─────────────────────────────────────────────────────────┐   │   │   │
│  │  │  │                   Main Content                          │   │   │   │
│  │  │  │                                                         │   │   │   │
│  │  │  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐      │   │   │   │
│  │  │  │  │  Dashboard  │ │  Usuarios   │ │  Residente  │      │   │   │   │
│  │  │  │  │             │ │             │ │             │      │   │   │   │
│  │  │  │  │ Stats Cards │ │ CRUD Users  │ │ CRUD Res.   │      │   │   │   │
│  │  │  │  │ Heatmap     │ │ Management  │ │ Management  │      │   │   │   │
│  │  │  │  └─────────────┘ └─────────────┘ └─────────────┘      │   │   │   │
│  │  │  │                                                         │   │   │   │
│  │  │  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐      │   │   │   │
│  │  │  │  │   Visitas   │ │ Visita Ext. │ │  Bitácora   │      │   │   │   │
│  │  │  │  │             │ │             │ │             │      │   │   │   │
│  │  │  │  │ Visit Mgmt  │ │ Ext. Visit  │ │ Audit Logs  │      │   │   │   │
│  │  │  │  │             │ │ Management  │ │             │      │   │   │   │
│  │  │  │  └─────────────┘ └─────────────┘ └─────────────┘      │   │   │   │
│  │  │  └─────────────────────────────────────────────────────────┘   │   │   │
│  │  └─────────────────────────────────────────────────────────────────┘   │   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                         Public Routes                                  │   │   │
│  │  ┌─────────────────────────────────────────────────────────────────┐   │   │
│  │  │                        Login.js                                 │   │   │
│  │  │                                                                 │   │   │
│  │  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐              │   │   │
│  │  │  │    Form     │ │  Auth API   │ │  Redirect   │              │   │   │
│  │  │  │ Components  │ │   Calls     │ │   Logic     │              │   │   │
│  │  │  └─────────────┘ └─────────────┘ └─────────────┘              │   │   │
│  │  └─────────────────────────────────────────────────────────────────┘   │   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## ⚙️ **ARQUITECTURA BACKEND**

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                          ⚙️ BACKEND ARCHITECTURE                                │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                            index.js                                    │   │   │
│  │  ┌─────────────────────────────────────────────────────────────────┐   │   │
│  │  │                    Express Server                               │   │   │
│  │  │                                                                 │   │   │
│  │  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐              │   │   │
│  │  │  │Middleware   │ │   Routes    │ │   Database  │              │   │   │
│  │  │  │             │ │             │ │  Connection │              │   │   │
│  │  │  │• CORS       │ │• /api/auth  │ │• Sequelize  │              │   │   │
│  │  │  │• Helmet     │ │• /api/users │ │• PostgreSQL │              │   │   │
│  │  │  │• Morgan     │ │• /api/visits│ │• Models     │              │   │   │
│  │  │  │• Auth       │ │• /api/access│ │             │              │   │   │
│  │  │  │• Audit      │ │• /api/audit │ │             │              │   │   │
│  │  │  └─────────────┘ └─────────────┘ └─────────────┘              │   │   │
│  │  └─────────────────────────────────────────────────────────────────┘   │   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                           Controllers                                   │   │   │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐      │   │   │
│  │  │    Auth     │ │   Access    │ │  Bitácora   │ │  Residentes │      │   │   │
│  │  │ Controller  │ │ Controller  │ │ Controller  │ │ Controller  │      │   │   │
│  │  │             │ │             │ │             │ │             │      │   │   │
│  │  │• Login      │ │• Dashboard  │ │• Event Log  │ │• CRUD Ops   │      │   │   │
│  │  │• Logout     │ │• Heatmap    │ │• Statistics │ │• Search     │      │   │   │
│  │  │• Register   │ │• Statistics │ │• Filtering  │ │• Validation │      │   │   │
│  │  │• JWT        │ │• Reports    │ │• Export     │ │• Relations  │      │   │   │
│  │  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘      │   │   │
│  │                                                                         │   │   │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐      │   │   │
│  │  │   Visitas   │ │ Visita Ext. │ │   Users     │ │   Persona   │      │   │   │
│  │  │ Controller  │ │ Controller  │ │ Controller  │ │ Controller  │      │   │   │
│  │  │             │ │             │ │             │ │             │      │   │   │
│  │  │• Visit CRUD │ │• Ext. CRUD  │ │• User CRUD  │ │• Person CRUD│      │   │   │
│  │  │• Status Mgmt│ │• Status Mgmt│ │• Role Mgmt  │ │• Relations  │      │   │   │
│  │  │• Validation │ │• Validation │ │• Permissions│ │• Validation │      │   │   │
│  │  │• Reports    │ │• Reports    │ │• Auth       │ │• Search     │      │   │   │
│  │  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘      │   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                            Models                                       │   │   │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐      │   │   │
│  │  │    User     │ │  Residente  │ │    Visita   │ │   Access    │      │   │   │
│  │  │             │ │             │ │             │ │    Log      │      │   │   │
│  │  │• id         │ │• id         │ │• id         │ │• id         │      │   │   │
│  │  │• email      │ │• nombre     │ │• residenteId│ │• userId     │      │   │   │
│  │  │• password   │ │• apellido   │ │• fecha      │ │• timestamp  │      │   │   │
│  │  │• role       │ │• documento  │ │• estado     │ │• action     │      │   │   │
│  │  │• status     │ │• telefono   │ │• observacion│ │• device     │      │   │   │
│  │  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘      │   │   │
│  │                                                                         │   │   │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐      │   │   │
│  │  │    Audit    │ │   Device    │ │    Area     │ │    Role     │      │   │   │
│  │  │             │ │             │ │             │ │             │      │   │   │
│  │  │• id         │ │• id         │ │• id         │ │• id         │      │   │   │
│  │  │• userId     │ │• name       │ │• nombre     │ │• name       │      │   │   │
│  │  │• action     │ │• type       │ │• descripcion│ │• permissions│      │   │   │
│  │  │• timestamp  │ │• location   │ │• status     │ │• level      │      │   │   │
│  │  │• details    │ │• status     │ │• created    │ │• status     │      │   │   │
│  │  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘      │   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## 🗄️ **ESTRUCTURA DE BASE DE DATOS**

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                         🗄️ DATABASE SCHEMA                                     │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                        PostgreSQL Database                              │   │   │
│  │  ┌─────────────────────────────────────────────────────────────────┐   │   │
│  │  │                    Core Tables                                 │   │   │
│  │  │                                                                 │   │   │
│  │  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐              │   │   │
│  │  │  │   usuarios  │ │  residentes │ │   visitas   │              │   │   │
│  │  │  │             │ │             │ │             │              │   │   │
│  │  │  │• id (PK)    │ │• id (PK)    │ │• id (PK)    │              │   │   │
│  │  │  │• email      │ │• nombre     │ │• residenteId│              │   │   │
│  │  │  │• password   │ │• apellido   │ │• fecha      │              │   │   │
│  │  │  │• role       │ │• documento  │ │• estado     │              │   │   │
│  │  │  │• status     │ │• telefono   │ │• observacion│              │   │   │
│  │  │  │• created    │ │• email      │ │• created    │              │   │   │
│  │  │  │• updated    │ │• created    │ │• updated    │              │   │   │
│  │  │  └─────────────┘ └─────────────┘ └─────────────┘              │   │   │
│  │  │                                                                 │   │   │
│  │  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐              │   │   │
│  │  │  │ visitas_ext │ │ access_logs │ │  auditoria  │              │   │   │
│  │  │  │             │ │             │ │             │              │   │   │
│  │  │  │• id (PK)    │ │• id (PK)    │ │• id (PK)    │              │   │   │
│  │  │  │• nombre     │ │• userId     │ │• userId     │              │   │   │
│  │  │  │• documento  │ │• timestamp  │ │• action     │              │   │   │
│  │  │  │• telefono   │ │• action     │ │• timestamp  │              │   │   │
│  │  │  │• motivo     │ │• device     │ │• details    │              │   │   │
│  │  │  │• estado     │ │• location   │ │• ip         │              │   │   │
│  │  │  │• created    │ │• success    │ │• userAgent  │              │   │   │
│  │  │  └─────────────┘ └─────────────┘ └─────────────┘              │   │   │
│  │  └─────────────────────────────────────────────────────────────────┘   │   │   │
│  │                                                                         │   │   │
│  │  ┌─────────────────────────────────────────────────────────────────┐   │   │
│  │  │                    Support Tables                               │   │   │
│  │  │                                                                 │   │   │
│  │  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐              │   │   │
│  │  │  │   roles     │ │  dispositivos│ │    areas    │              │   │   │
│  │  │  │             │ │             │ │             │              │   │   │
│  │  │  │• id (PK)    │ │• id (PK)    │ │• id (PK)    │              │   │   │
│  │  │  │• name       │ │• name       │ │• nombre     │              │   │   │
│  │  │  │• permissions│ │• type       │ │• descripcion│              │   │   │
│  │  │  │• level      │ │• location   │ │• status     │              │   │   │
│  │  │  │• status     │ │• status     │ │• created    │              │   │   │
│  │  │  └─────────────┘ └─────────────┘ └─────────────┘              │   │   │
│  │  │                                                                 │   │   │
│  │  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐              │   │   │
│  │  │  │  sessions   │ │ system_config│ │   profiles  │              │   │   │
│  │  │  │             │ │             │ │             │              │   │   │
│  │  │  │• id (PK)    │ │• id (PK)    │ │• id (PK)    │              │   │   │
│  │  │  │• userId     │ │• key        │ │• userId     │              │   │   │
│  │  │  │• token      │ │• value      │ │• avatar     │              │   │   │
│  │  │  │• expires    │ │• type       │ │• preferences│              │   │   │
│  │  │  │• created    │ │• updated    │ │• created    │              │   │   │
│  │  │  └─────────────┘ └─────────────┘ └─────────────┘              │   │   │
│  │  └─────────────────────────────────────────────────────────────────┘   │   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                       Relationships                                    │   │   │
│  │                                                                         │   │   │
│  │  usuarios ──┐                                                           │   │   │
│  │            │ 1:N                                                        │   │   │
│  │            └──► access_logs                                            │   │   │
│  │                                                                         │   │   │
│  │  usuarios ──┐                                                           │   │   │
│  │            │ 1:N                                                        │   │   │
│  │            └──► auditoria                                               │   │   │
│  │                                                                         │   │   │
│  │  usuarios ──┐                                                           │   │   │
│  │            │ 1:1                                                        │   │   │
│  │            └──► profiles                                                │   │   │
│  │                                                                         │   │   │
│  │  residentes ──┐                                                         │   │   │
│  │              │ 1:N                                                      │   │   │
│  │              └──► visitas                                               │   │   │
│  │                                                                         │   │   │
│  │  roles ──┐                                                              │   │   │
│  │         │ 1:N                                                           │   │   │
│  │         └──► usuarios                                                   │   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## 🚀 **PIPELINE DE DEPLOYMENT**

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                        🚀 DEPLOYMENT PIPELINE                                   │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                        Development Phase                               │   │   │
│  │                                                                         │   │   │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                │   │   │
│  │  │   📝 Code   │    │   🧪 Test   │    │   📦 Build  │                │   │   │
│  │  │             │    │             │    │             │                │   │   │
│  │  │• Frontend   │───►│• Unit Tests │───►│• Docker     │                │   │   │
│  │  │• Backend    │    │• Integration│    │• Images     │                │   │   │
│  │  │• Database   │    │• E2E Tests  │    │• Compose    │                │   │   │
│  │  └─────────────┘    └─────────────┘    └─────────────┘                │   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                        Git & CI/CD Phase                               │   │   │
│  │                                                                         │   │   │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                │   │   │
│  │  │   🐙 Git    │    │   🔄 GitHub │    │   🛡️ Security│               │   │   │
│  │  │             │    │   Actions   │    │    Scan     │                │   │   │
│  │  │• Commit     │───►│• CI/CD      │───►│• Trivy      │                │   │   │
│  │  │• Push       │    │• Build      │    │• SAST       │                │   │   │
│  │  │• Tag        │    │• Test       │    │• Dependencies│               │   │   │
│  │  └─────────────┘    └─────────────┘    └─────────────┘                │   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                        Registry Phase                                  │   │   │
│  │                                                                         │   │   │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                │   │   │
│  │  │   🐳 Docker │    │   🌊 Docker │    │   📋 GitHub │                │   │   │
│  │  │   Registry  │    │    Hub      │    │  Registry   │                │   │   │
│  │  │             │    │             │    │             │                │   │   │
│  │  │• Build      │───►│• Push       │───►│• Push       │                │   │   │
│  │  │• Tag        │    │• Public     │    │• Private    │                │   │   │
│  │  │• Scan       │    │• Versioned  │    │• Versioned  │                │   │   │
│  │  └─────────────┘    └─────────────┘    └─────────────┘                │   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                        Deployment Phase                                │   │   │
│  │                                                                         │   │   │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                │   │   │
│  │  │   🧪 Staging│    │   🚀 Prod   │    │   📊 Monitor│                │   │   │
│  │  │             │    │             │    │             │                │   │   │
│  │  │• Deploy     │───►│• Deploy     │───►│• Health     │                │   │   │
│  │  │• Test       │    │• Scale      │    │• Logs       │                │   │   │
│  │  │• Validate   │    │• Monitor    │    │• Metrics    │                │   │   │
│  │  └─────────────┘    └─────────────┘    └─────────────┘                │   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## 🔧 **CONFIGURACIÓN DE SERVICIOS**

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                      🔧 SERVICE CONFIGURATION                                  │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                        Frontend Service                                │   │   │
│  │                                                                         │   │   │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                │   │   │
│  │  │   📦 React  │    │   🌐 Nginx  │    │   🐳 Docker │                │   │   │
│  │  │             │    │             │    │             │                │   │   │
│  │  │• Build      │───►│• Serve      │───►│• Container  │                │   │   │
│  │  │• Optimize   │    │• Proxy      │    │• Port 3000  │                │   │   │
│  │  │• Bundle     │    │• Static     │    │• Health     │                │   │   │
│  │  └─────────────┘    └─────────────┘    └─────────────┘                │   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                        Backend Service                                 │   │   │
│  │                                                                         │   │   │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                │   │   │
│  │  │   ⚙️ Node.js │    │   🗄️ DB     │    │   🐳 Docker │                │   │   │
│  │  │             │    │             │    │             │                │   │   │
│  │  │• Express    │───►│• Sequelize  │───►│• Container  │                │   │   │
│  │  │• API        │    │• Models     │    │• Port 3001  │                │   │   │
│  │  │• Middleware │    │• Migrations │    │• Health     │                │   │   │
│  │  └─────────────┘    └─────────────┘    └─────────────┘                │   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                       Database Service                                 │   │   │
│  │                                                                         │   │   │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                │   │   │
│  │  │   🗄️ Postgres│    │   📊 Data    │    │   🐳 Docker │                │   │   │
│  │  │             │    │             │    │             │                │   │   │
│  │  │• Database   │───►│• Persistent │───►│• Container  │                │   │   │
│  │  │• Tables     │    │• Volumes    │    │• Port 5432  │                │   │   │
│  │  │• Users      │    │• Backup     │    │• Health     │                │   │   │
│  │  └─────────────┘    └─────────────┘    └─────────────┘                │   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## 📊 **MÉTRICAS Y MONITOREO**

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                        📊 MONITORING & METRICS                                  │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                        Health Checks                                   │   │   │
│  │                                                                         │   │   │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                │   │   │
│  │  │   🌐 Front  │    │   ⚙️ Back   │    │   🗄️ DB     │                │   │   │
│  │  │             │    │             │    │             │                │   │   │
│  │  │• HTTP 200   │    │• API Ready  │    │• DB Ready   │                │   │   │
│  │  │• Response   │    │• JWT Valid  │    │• Connection │                │   │   │
│  │  │• Static     │    │• Database   │    │• Queries    │                │   │   │
│  │  └─────────────┘    └─────────────┘    └─────────────┘                │   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                        Performance Metrics                             │   │   │
│  │                                                                         │   │   │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                │   │   │
│  │  │   ⏱️ Response│    │   💾 Memory │    │   💿 Disk   │                │   │   │
│  │  │             │    │             │    │             │                │   │   │
│  │  │• API Calls  │    │• Usage      │    │• Usage      │                │   │   │
│  │  │• Load Time  │    │• Allocation │    │• I/O        │                │   │   │
│  │  │• Throughput │    │• GC Stats   │    │• Growth     │                │   │   │
│  │  └─────────────┘    └─────────────┘    └─────────────┘                │   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                        Security Metrics                                │   │   │
│  │                                                                         │   │   │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                │   │   │
│  │  │   🔐 Auth   │    │   🛡️ Audit  │    │   🚨 Alert  │                │   │   │
│  │  │             │    │             │    │             │                │   │   │
│  │  │• Login Rate │    │• Events     │    │• Thresholds │                │   │   │
│  │  │• Failed     │    │• Actions    │    │• Notifications│              │   │   │
│  │  │• Sessions   │    │• Users      │    │• Escalation │                │   │   │
│  │  └─────────────┘    └─────────────┘    └─────────────┘                │   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 🎯 **RESUMEN DE ARQUITECTURA**

La plataforma ControlAcceso implementa una **arquitectura de microservicios containerizada** con:

- ✅ **Frontend React** con Material-UI y Nginx
- ✅ **Backend Node.js** con Express y Sequelize ORM  
- ✅ **Base de datos PostgreSQL** con esquema normalizado
- ✅ **Containerización Docker** con docker-compose
- ✅ **CI/CD automatizado** con GitHub Actions
- ✅ **Deployment multi-registry** (GitHub, Docker, DockerHub)
- ✅ **Monitoreo y health checks** integrados
- ✅ **Seguridad** implementada en todas las capas

El sistema está diseñado para ser **escalable**, **mantenible** y **fácil de desplegar** en cualquier entorno de producción.


